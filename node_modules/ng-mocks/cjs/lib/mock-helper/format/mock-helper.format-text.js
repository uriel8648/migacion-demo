"use strict";
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
var format_handler_1 = __importDefault(require("./format-handler"));
var handle_text_1 = __importDefault(require("./handle-text"));
var is_html_element_1 = __importDefault(require("./is-html-element"));
var is_text_1 = __importDefault(require("./is-text"));
var normalizeValue = function (html) { return (html ? html.replace(new RegExp('\\s+', 'mg'), ' ') : ''); };
var getElementValue = function (element, outer) {
    var _a;
    var value = (_a = element.textContent) !== null && _a !== void 0 ? _a : '';
    return outer ? value : value.trim();
};
var handlePrimitives = function (format, value, outer) {
    if (typeof value === 'string' || value === undefined) {
        var result = normalizeValue(value);
        return outer ? result : result.trim();
    }
    if ((0, is_html_element_1.default)(value)) {
        return format(getElementValue(value, outer));
    }
    if ((0, is_text_1.default)(value)) {
        return handlePrimitives(format, (0, handle_text_1.default)(value), outer);
    }
    return undefined;
};
exports.default = (function () { return (0, format_handler_1.default)(handlePrimitives); })();
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibW9jay1oZWxwZXIuZm9ybWF0LXRleHQuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi8uLi8uLi8uLi9saWJzL25nLW1vY2tzL3NyYy9saWIvbW9jay1oZWxwZXIvZm9ybWF0L21vY2staGVscGVyLmZvcm1hdC10ZXh0LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7O0FBQUEsb0VBQTZDO0FBQzdDLDhEQUF1QztBQUN2QyxzRUFBOEM7QUFDOUMsc0RBQStCO0FBRS9CLElBQU0sY0FBYyxHQUFHLFVBQUMsSUFBd0IsSUFBYSxPQUFBLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsT0FBTyxDQUFDLElBQUksTUFBTSxDQUFDLE1BQU0sRUFBRSxJQUFJLENBQUMsRUFBRSxHQUFHLENBQUMsQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDLEVBQXpELENBQXlELENBQUM7QUFFdkgsSUFBTSxlQUFlLEdBQUcsVUFBQyxPQUFvQixFQUFFLEtBQWM7O0lBQzNELElBQU0sS0FBSyxHQUFHLE1BQUEsT0FBTyxDQUFDLFdBQVcsbUNBQUksRUFBRSxDQUFDO0lBRXhDLE9BQU8sS0FBSyxDQUFDLENBQUMsQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFDLEtBQUssQ0FBQyxJQUFJLEVBQUUsQ0FBQztBQUN0QyxDQUFDLENBQUM7QUFFRixJQUFNLGdCQUFnQixHQUFHLFVBQUMsTUFBVyxFQUFFLEtBQVUsRUFBRSxLQUFjO0lBQy9ELElBQUksT0FBTyxLQUFLLEtBQUssUUFBUSxJQUFJLEtBQUssS0FBSyxTQUFTLEVBQUU7UUFDcEQsSUFBTSxNQUFNLEdBQUcsY0FBYyxDQUFDLEtBQUssQ0FBQyxDQUFDO1FBRXJDLE9BQU8sS0FBSyxDQUFDLENBQUMsQ0FBQyxNQUFNLENBQUMsQ0FBQyxDQUFDLE1BQU0sQ0FBQyxJQUFJLEVBQUUsQ0FBQztLQUN2QztJQUNELElBQUksSUFBQSx5QkFBYSxFQUFDLEtBQUssQ0FBQyxFQUFFO1FBQ3hCLE9BQU8sTUFBTSxDQUFDLGVBQWUsQ0FBQyxLQUFLLEVBQUUsS0FBSyxDQUFDLENBQUMsQ0FBQztLQUM5QztJQUNELElBQUksSUFBQSxpQkFBTSxFQUFDLEtBQUssQ0FBQyxFQUFFO1FBQ2pCLE9BQU8sZ0JBQWdCLENBQUMsTUFBTSxFQUFFLElBQUEscUJBQVUsRUFBQyxLQUFLLENBQUMsRUFBRSxLQUFLLENBQUMsQ0FBQztLQUMzRDtJQUVELE9BQU8sU0FBUyxDQUFDO0FBQ25CLENBQUMsQ0FBQztBQUVGLGtCQUFlLENBQUMsY0FBTSxPQUFBLElBQUEsd0JBQWEsRUFBQyxnQkFBZ0IsQ0FBQyxFQUEvQixDQUErQixDQUFDLEVBQUUsQ0FBQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBmb3JtYXRIYW5kbGVyIGZyb20gJy4vZm9ybWF0LWhhbmRsZXInO1xuaW1wb3J0IGhhbmRsZVRleHQgZnJvbSAnLi9oYW5kbGUtdGV4dCc7XG5pbXBvcnQgaXNIdG1sRWxlbWVudCBmcm9tICcuL2lzLWh0bWwtZWxlbWVudCc7XG5pbXBvcnQgaXNUZXh0IGZyb20gJy4vaXMtdGV4dCc7XG5cbmNvbnN0IG5vcm1hbGl6ZVZhbHVlID0gKGh0bWw6IHN0cmluZyB8IHVuZGVmaW5lZCk6IHN0cmluZyA9PiAoaHRtbCA/IGh0bWwucmVwbGFjZShuZXcgUmVnRXhwKCdcXFxccysnLCAnbWcnKSwgJyAnKSA6ICcnKTtcblxuY29uc3QgZ2V0RWxlbWVudFZhbHVlID0gKGVsZW1lbnQ6IEhUTUxFbGVtZW50LCBvdXRlcjogYm9vbGVhbik6IHN0cmluZyA9PiB7XG4gIGNvbnN0IHZhbHVlID0gZWxlbWVudC50ZXh0Q29udGVudCA/PyAnJztcblxuICByZXR1cm4gb3V0ZXIgPyB2YWx1ZSA6IHZhbHVlLnRyaW0oKTtcbn07XG5cbmNvbnN0IGhhbmRsZVByaW1pdGl2ZXMgPSAoZm9ybWF0OiBhbnksIHZhbHVlOiBhbnksIG91dGVyOiBib29sZWFuKTogc3RyaW5nIHwgdW5kZWZpbmVkID0+IHtcbiAgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gJ3N0cmluZycgfHwgdmFsdWUgPT09IHVuZGVmaW5lZCkge1xuICAgIGNvbnN0IHJlc3VsdCA9IG5vcm1hbGl6ZVZhbHVlKHZhbHVlKTtcblxuICAgIHJldHVybiBvdXRlciA/IHJlc3VsdCA6IHJlc3VsdC50cmltKCk7XG4gIH1cbiAgaWYgKGlzSHRtbEVsZW1lbnQodmFsdWUpKSB7XG4gICAgcmV0dXJuIGZvcm1hdChnZXRFbGVtZW50VmFsdWUodmFsdWUsIG91dGVyKSk7XG4gIH1cbiAgaWYgKGlzVGV4dCh2YWx1ZSkpIHtcbiAgICByZXR1cm4gaGFuZGxlUHJpbWl0aXZlcyhmb3JtYXQsIGhhbmRsZVRleHQodmFsdWUpLCBvdXRlcik7XG4gIH1cblxuICByZXR1cm4gdW5kZWZpbmVkO1xufTtcblxuZXhwb3J0IGRlZmF1bHQgKCgpID0+IGZvcm1hdEhhbmRsZXIoaGFuZGxlUHJpbWl0aXZlcykpKCk7XG4iXX0=